function x = traprnd(xi, yi, N)% Generate random sample from a trapezoidal function% This function only works for three points% xi = vector of size 2% yi = vector of size 2% N = sample size% x = vector of size N with the sample% Area of the trapezoidsA = (xi(2) - xi(1))*(yi(1) + yi(2))/2;% Slope of the linem = (yi(2) - yi(1))/(xi(2) - xi(1));if (m ~= 0)  x = xi(1) + (-yi(1) + sqrt(yi(1)^2 + 2*A*rand(N,1)*m))/m;else  x = xi(1) + A*rand(N,1)/yi(1);endifendfunction